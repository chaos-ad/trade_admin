
<!DOCTYPE HTML>
<html>
    <head>
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.js"></script>
        <script type="text/javascript">

            function parse_qs() {
                var result = {};
                if (window.location.href.indexOf('?') > 0) {
                    var query = window.location.href.substring(window.location.href.indexOf('?') + 1);
                    var pairs = query.split('&');
                    for (i = 0; i < pairs.length; ++i) {
                        kv = pairs[i].split('=');
                        result[kv[0]]=kv[1];
                    }
                }
                return result;
            }

            $(function() {
                var grouping = [
                    ['minute',  [1, 2, 5, 10, 15, 30]],
                    ['hour',    [1, 2, 3, 4, 6, 8, 12]],
                    ['day',     [1]],
                    ['week',    [1]],
                    ['month',   [1, 3, 6]]
                ];
                var qs = parse_qs();
                var url = "api/tester?" + jQuery.param(qs);
                var type = "candlestick";
                if (qs.type) {
                    type = qs.type;
                }
                $.getJSON(url, function(data) {
                    var bids    = data.bids;
                    var history = data.history;

                    // create the chart
                    chart = new Highcharts.StockChart({
                        chart : {
                            renderTo : 'container'
                        },
                        rangeSelector : {
                            selected : 1
                        },
                        series : [{
                            type : type,
                            data : data.history.map(function(item) {
                                return [item.time + "000", item.open, item.high, item.low, item.close];
                            }),
                            dataGrouping : {
                                units: grouping
                            }
                        }]
                    });
                });
            });

        </script>
    </head>
    <body>
        <div id="container" style="height: 400px; min-width: 600px"></div>
<!--
        <button id="button1">Add series 1</button>
        <button id="button2">Add series 2</button>-->

        <script type="text/javascript" src="/js/highstock.src.js"></script>
        <script type="text/javascript" src="/js/modules/exporting.src.js"></script>
        <script type="text/javascript" src="http://www.highcharts.com/samples/data/three-series-1000-points.js"></script>


    </body>
</html>
